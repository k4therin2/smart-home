<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zones & Devices - Smart Home</title>
    <link rel="icon" type="image/svg+xml" href="/static/icons/icon.svg">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Zones & Devices</h1>
            <nav>
                <a href="/">Home</a>
                <a href="/zones" class="active">Zones</a>
            </nav>
        </header>

        <main id="zones-main">
            <!-- Toolbar -->
            <div class="toolbar">
                <button id="sync-ha-btn" class="btn btn-secondary">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16"/>
                    </svg>
                    Sync from HA
                </button>
                <button id="start-onboarding-btn" class="btn btn-primary">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    Start Device Onboarding
                </button>
                <button id="sync-hue-btn" class="btn btn-secondary">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8"/>
                    </svg>
                    Sync to Hue
                </button>
            </div>

            <!-- Onboarding Wizard (hidden by default) -->
            <div id="onboarding-wizard" class="wizard hidden">
                <div class="wizard-header">
                    <h2>Device Onboarding</h2>
                    <button id="close-wizard-btn" class="btn-icon" title="Close wizard">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <div class="wizard-content">
                    <!-- Step 1: Patterns active -->
                    <div id="patterns-info" class="patterns-info">
                        <p class="instruction">Your lights are now showing different patterns. Walk through your home and note what you see.</p>
                        <div id="patterns-guide" class="patterns-guide">
                            <p class="loading">Starting patterns...</p>
                        </div>
                    </div>

                    <!-- Step 2: Transcript input -->
                    <div id="transcript-section" class="transcript-section">
                        <label for="transcript-input">Describe what you see:</label>
                        <textarea
                            id="transcript-input"
                            class="transcript-input"
                            placeholder="Example: The solid red one is in the office upstairs, that's my desk lamp. The pulsing blue is in the living room downstairs. The blinking green is in the kitchen..."
                            rows="4"
                        ></textarea>
                        <p class="hint">Include room names, zones (upstairs/downstairs), and names for lights if you want.</p>
                        <button id="parse-transcript-btn" class="btn btn-primary">Apply Changes</button>
                    </div>

                    <!-- Results -->
                    <div id="onboarding-results" class="onboarding-results hidden">
                        <h3>Results</h3>
                        <ul id="results-list"></ul>
                        <div id="unmapped-warning" class="unmapped-warning hidden">
                            <p>Some lights were not matched. Add more details above and try again.</p>
                        </div>
                    </div>
                </div>

                <div class="wizard-footer">
                    <button id="cancel-onboarding-btn" class="btn btn-secondary">Stop & Close</button>
                </div>
            </div>

            <!-- Zones List -->
            <div id="zones-container" class="zones-container">
                <h2>Zones</h2>
                <div id="zones-list" class="zones-list">
                    <!-- Zones will be populated by JavaScript -->
                    <p class="loading">Loading zones...</p>
                </div>
            </div>

            <!-- Unassigned Devices -->
            <div id="unassigned-container" class="unassigned-container">
                <h2>Unassigned Devices</h2>
                <ul id="unassigned-list" class="unassigned-list">
                    <!-- Populated by JavaScript -->
                </ul>
            </div>
        </main>
    </div>

    <script src="/static/zones.js?v=5"></script>
</body>
</html>
