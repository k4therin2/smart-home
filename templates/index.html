<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="Smart Home Assistant - Control your home with natural language commands">
    <title>Smart Home Assistant</title>

    <!-- Mobile Web App Configuration -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Smart Home">
    <meta name="theme-color" content="#0f0f0f">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Favicons and Touch Icons -->
    <link rel="icon" type="image/svg+xml" href="/static/icons/icon.svg">
    <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/icons/apple-touch-icon-120.png">

    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container" role="application" aria-label="Smart Home Assistant Interface">

        <!-- Header with system status -->
        <header role="banner">
            <h1>Smart Home</h1>
            <nav>
                <a href="/" class="active">Home</a>
                <a href="/zones">Zones</a>
            </nav>
            <div
                id="status-indicator"
                class="status-badge status-unknown"
                role="status"
                aria-live="polite"
                aria-label="System status"
            >
                <span class="status-dot" aria-hidden="true"></span>
                <span id="status-text">Connecting...</span>
            </div>
        </header>

        <main role="main">

            <!-- Command Input Section -->
            <section
                class="command-section"
                aria-label="Command input"
                data-section="command-input"
            >
                <form id="command-form" role="search" aria-label="Submit command to smart home">
                    <div class="input-group">
                        <label for="command-input" class="visually-hidden">Enter command</label>
                        <input
                            type="text"
                            id="command-input"
                            name="command"
                            placeholder="Enter a command... (e.g., 'turn on living room lights')"
                            autocomplete="off"
                            autofocus
                            aria-describedby="command-hint"
                        >
                        <button
                            type="submit"
                            id="submit-btn"
                            aria-label="Send command"
                            title="Send command"
                        >
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                <path d="M22 2L11 13M22 2L15 22L11 13L2 9L22 2Z"/>
                            </svg>
                        </button>
                    </div>
                    <span id="command-hint" class="visually-hidden">
                        Type a natural language command to control your smart home devices
                    </span>
                </form>
                <button
                    id="voice-btn"
                    class="voice-button"
                    type="button"
                    title="Voice input (browser speech recognition)"
                    aria-label="Start voice input"
                    aria-pressed="false"
                >
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        <line x1="12" y1="19" x2="12" y2="23"/>
                        <line x1="8" y1="23" x2="16" y2="23"/>
                    </svg>
                </button>
            </section>

            <!-- Response Display - where assistant responses appear -->
            <section
                class="response-section"
                aria-label="Assistant responses"
                data-section="responses"
            >
                <h2 class="visually-hidden">Assistant Responses</h2>
                <div
                    id="response-area"
                    role="log"
                    aria-live="polite"
                    aria-atomic="false"
                    aria-relevant="additions"
                >
                    <p class="placeholder-text" data-placeholder="true">Responses will appear here...</p>
                </div>
            </section>

            <!-- Command History - clickable to reuse commands -->
            <section
                class="history-section"
                aria-label="Command history"
                data-section="history"
            >
                <h2 id="history-heading">Recent Commands</h2>
                <ul
                    id="history-list"
                    role="list"
                    aria-labelledby="history-heading"
                    aria-description="Click any command to load it into the input field"
                >
                    <li class="placeholder-text" data-placeholder="true">No commands yet</li>
                </ul>
            </section>

            <!-- Todo List Section (WP-4.1) -->
            <section
                class="todo-section"
                aria-label="Todo list"
                data-section="todos"
            >
                <h2 id="todos-heading">Todo Lists</h2>

                <!-- List Selector Tabs -->
                <div class="todo-tabs" role="tablist" aria-label="Todo lists">
                    <button
                        class="todo-tab active"
                        role="tab"
                        aria-selected="true"
                        data-list="default"
                    >
                        Default
                    </button>
                    <button
                        class="todo-tab"
                        role="tab"
                        aria-selected="false"
                        data-list="shopping"
                    >
                        Shopping
                    </button>
                    <button
                        class="todo-tab"
                        role="tab"
                        aria-selected="false"
                        data-list="work"
                    >
                        Work
                    </button>
                </div>

                <!-- Quick Add Form -->
                <form id="todo-add-form" class="todo-add-form">
                    <input
                        type="text"
                        id="todo-input"
                        placeholder="Add a new item..."
                        autocomplete="off"
                        aria-label="New todo item"
                    >
                    <button type="submit" aria-label="Add todo">+</button>
                </form>

                <!-- Todo Items List -->
                <ul
                    id="todo-list"
                    class="todo-list"
                    role="list"
                    aria-labelledby="todos-heading"
                >
                    <li class="placeholder-text" data-placeholder="true">Loading...</li>
                </ul>

                <!-- Show Completed Toggle -->
                <label class="todo-toggle">
                    <input type="checkbox" id="show-completed">
                    Show completed items
                </label>
            </section>

            <!-- Device Status Dashboard -->
            <section
                class="devices-section"
                aria-label="Device status"
                data-section="devices"
            >
                <h2 id="devices-heading">Devices</h2>
                <div
                    id="devices-grid"
                    class="devices-grid"
                    role="list"
                    aria-labelledby="devices-heading"
                >
                    <p class="placeholder-text" data-placeholder="true">No devices connected</p>
                </div>
            </section>

            <!-- System Logs Section (WP-6.1) -->
            <section
                class="logs-section"
                aria-label="System logs"
                data-section="logs"
            >
                <h2 id="logs-heading">
                    System Logs
                    <button
                        class="logs-toggle-btn"
                        id="logs-toggle"
                        aria-expanded="false"
                        aria-controls="logs-panel"
                        title="Toggle logs panel"
                    >
                        ▼
                    </button>
                </h2>

                <div id="logs-panel" class="logs-panel collapsed">
                    <!-- Log Type Tabs -->
                    <div class="logs-tabs" role="tablist" aria-label="Log types">
                        <button
                            class="logs-tab active"
                            role="tab"
                            aria-selected="true"
                            data-log-type="main"
                        >
                            Main
                        </button>
                        <button
                            class="logs-tab"
                            role="tab"
                            aria-selected="false"
                            data-log-type="error"
                        >
                            Errors
                        </button>
                        <button
                            class="logs-tab"
                            role="tab"
                            aria-selected="false"
                            data-log-type="api"
                        >
                            API
                        </button>
                    </div>

                    <!-- Log Filters -->
                    <div class="logs-filters">
                        <select id="log-level-filter" aria-label="Filter by log level">
                            <option value="">All Levels</option>
                            <option value="DEBUG">DEBUG</option>
                            <option value="INFO">INFO</option>
                            <option value="WARNING">WARNING</option>
                            <option value="ERROR">ERROR</option>
                            <option value="CRITICAL">CRITICAL</option>
                        </select>

                        <input
                            type="text"
                            id="log-search"
                            placeholder="Search logs..."
                            aria-label="Search log messages"
                        >

                        <div class="logs-actions">
                            <button
                                id="logs-refresh-btn"
                                class="logs-action-btn"
                                title="Refresh logs"
                                aria-label="Refresh logs"
                            >
                                ↻
                            </button>
                            <button
                                id="logs-tail-btn"
                                class="logs-action-btn"
                                title="Toggle real-time updates"
                                aria-label="Toggle real-time log updates"
                                aria-pressed="false"
                            >
                                ▶
                            </button>
                            <button
                                id="logs-export-btn"
                                class="logs-action-btn"
                                title="Export logs"
                                aria-label="Export logs to file"
                            >
                                ↓
                            </button>
                        </div>
                    </div>

                    <!-- Log Stats -->
                    <div id="log-stats" class="log-stats">
                        <span id="log-count">-</span> entries
                    </div>

                    <!-- Log Entries -->
                    <div
                        id="logs-container"
                        class="logs-container"
                        role="log"
                        aria-live="polite"
                        aria-label="Log entries"
                    >
                        <p class="placeholder-text" data-placeholder="true">Click to load logs...</p>
                    </div>

                    <!-- Pagination -->
                    <div class="logs-pagination">
                        <button id="logs-prev" class="logs-page-btn" disabled>← Prev</button>
                        <span id="logs-page-info">Page 1</span>
                        <button id="logs-next" class="logs-page-btn">Next →</button>
                    </div>
                </div>
            </section>

        </main>

        <footer role="contentinfo">
            <p>Smart Home Assistant - Local - Private - LLM-Powered</p>
        </footer>

    </div>

    <!-- API Documentation for LLM agents (hidden from visual display) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Smart Home Assistant",
        "description": "Natural language interface for smart home control",
        "applicationCategory": "Home Automation",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "potentialAction": {
            "@type": "ControlAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "/api/command",
                "httpMethod": "POST",
                "contentType": "application/json"
            },
            "actionStatus": "PotentialActionStatus"
        }
    }
    </script>

    <!--
    API Reference for LLM Agents:

    POST /api/command
    Request: {"command": "natural language command string"}
    Response: {"success": true/false, "response": "text response", "command": "echoed command"}

    GET /api/status
    Response: {"system": "operational|warning|error", "agent": "status", "home_assistant": "status", "devices": []}

    GET /api/history
    Response: {"history": ["command1", "command2", ...]}

    Example commands:
    - "turn on living room lights"
    - "set bedroom lights to 50%"
    - "make the kitchen cozy"
    - "what's the status of the living room?"
    -->

    <script src="/static/app.js"></script>
</body>
</html>
